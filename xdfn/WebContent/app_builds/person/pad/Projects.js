Ext.define("xdfn.person.pad.Projects",{extend:"Ext.ux.portal.Portlet",id:"projs",layout:{type:"fit"},title:"最近项目",height:220,listeners:{destroy:function(a,b){Ext.getCmp("PersonPad").down('menucheckitem[text="最近项目"]').setChecked(false)}},getTools:function(){var a=this;return[{xtype:"tool",type:"refresh",handler:function(f,d,c,b){a.projStore.load()}}]},initComponent:function(){var a=this;a.projStore=Ext.create("xdfn.project.store.ProjectsJsonStore",{autoLoad:true,proxy:{type:"ajax",url:"./projectMgr.do?method=getProjectList",reader:{type:"json",root:"data"}}});a.tools=a.getTools();a.items=[{xtype:"gridpanel",forceFit:true,store:a.projStore,flex:1,border:false,columns:[{xtype:"gridcolumn",dataIndex:"ID_VIEW",text:"ID",hidden:true,hideable:false},{xtype:"gridcolumn",dataIndex:"V_PRO_NO_VIEW",text:"项目编号"},{xtype:"gridcolumn",dataIndex:"V_PRO_NAME_VIEW",text:"项目名称"},{xtype:"gridcolumn",dataIndex:"V_PRO_PHASE_VIEW",text:"项目所处阶段"}],viewConfig:{},dockedItems:[{xtype:"pagingtoolbar",displayInfo:true,store:a.projStore,dock:"bottom"}]}];a.callParent(arguments);a.down("gridpanel").on("itemdblclick",a.OnGridItemDbClick,a)},OnGridItemDbClick:function(i,b,k,c,d,f){var h=this,g=h.up("tabpanel"),a=Ext.getCmp("Projects");if(a==undefined){g.setActiveTab(g.add(Ext.create("xdfn.project.Projects",{ID:b.get("ID_VIEW")})))}else{g.setActiveTab(a);var j=a.down("gridpanel").getStore();Ext.apply(j.getProxy(),{extraParams:{ID:b.get("ID_VIEW")}});j.load()}}});