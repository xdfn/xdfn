Ext.define("xdfn.person.PersonAddress",{extend:"xdfn.person.ui.PersonAddress",initComponent:function(){var a=this;a.addrStore=Ext.create("xdfn.person.store.PersonAddressJsonStore");a.callParent(arguments);a.down('button[text="查找"]').on("click",a.OnSearchBtnClick,a);a.down('button[text="重置"]').on("click",a.OnResetBtnClick,a);a.down('button[text="导出"]').on("click",a.OnExportBtnClick,a)},OnSearchBtnClick:function(a,d,b){var c=this;Ext.apply(c.addrStore.getProxy(),{url:"./userManage.do?method=getAddrList",extraParams:{V_USER_NAME:c.down("textfield[name=V_USER_NAME]").getValue(),V_DEPT_ID:c.down("combotree[name=V_DEPT_ID]").getSubmitValue()}});c.addrStore.loadPage(1)},OnResetBtnClick:function(a,d,b){var c=this;c.down("textfield[name=V_USER_NAME]").reset();c.down("combotree[name=V_DEPT_ID]").reset()},OnExportBtnClick:function(a,d,b){var c=this;xdfn.user.Rights.hasRights("GRPT-TXL-2",function(){c.addrStore.load({limit:c.addrStore.getTotalCount(),scope:this,callback:function(g,f,h){var e=Ext.ux.exporter.Exporter.exportGrid(a.up("gridpanel"),"excel",{title:"通讯录"});document.location="data:application/vnd.ms-excel;base64,"+Ext.ux.exporter.Base64.encode(e)}})})}});